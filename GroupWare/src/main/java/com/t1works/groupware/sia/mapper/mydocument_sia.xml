<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mydocument_sia">

	<!-- 내문서함 - 수신함 - 일반결재문서에 해당하는 문서 조회하기  -->
	<select id="getnorm_reclist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, ncat, ncatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, ncat, ncatname
			from tbl_approval A join tbl_norapproval B
			on A.ano = B.fk_ano
			where apaper = '0'
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and ncat in(${a})
			</if>
			and (arecipient1 = #{userid} and approvaldate1 is null) or (arecipient2 = #{userid} and approvaldate2 is null) or (arecipient3 = #{userid} and approvaldate3 is null)
		) V
		where rno between #{startRno} and #{endRno}
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 글의 총 페이지수를 알아오기 -->
	<select id="getTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_norapproval B
		on A.ano = B.fk_ano
		where apaper = '0'
		and (arecipient1 = #{userid} and approvaldate1 is null) or (arecipient2 = #{userid} and approvaldate2 is null) or (arecipient3 = #{userid} and approvaldate3 is null)
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and ncat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 문서 한 개 상세보기 -->
	<select id="myDocuNorm_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select ncatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, ncat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3, pname 
		<choose>
			<when test="ncatname eq '회의록'">
				, mdate
			</when>
			<when test="ncatname eq '위임장'">
				, fk_wiimdate 
			</when>
			<when test="ncatname eq '협조공문'">
				, nvl(comname, '없습니다.') as comname
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="ncatname eq '회의록'">
				left join tbl_minutes m 
				on m.fk_ano = a.ano
			</when>
			<when test="ncatname eq '위임장'">
				left join tbl_wiimjang w 
				on w.fk_ano = a.ano
			</when>
			<when test="ncatname eq '협조공문'">
				left join tbl_coofficial c 
				on c.fk_ano = a.ano
			</when>
			<otherwise>
				left join tbl_exofficial e 
				on e.fk_ano = a.ano
			</otherwise>
		</choose>		
		left join tbl_norapproval n
		on a.ano = n.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 1 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 수신함 - 지출결재문서에 해당하는 문서 조회하기 -->
	<select id="getSpend_reclist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, scat, scatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, scat, scatname
			from tbl_approval A join tbl_spenda B
			on A.ano = B.fk_ano
			where apaper = '0'
			and (arecipient1 = #{userid} and approvaldate1 is null) or (arecipient2 = #{userid} and approvaldate2 is null) or (arecipient3 = #{userid} and approvaldate3 is null)
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and scat in(${a})
			</if>			
		) V
		where rno between #{startRno} and #{endRno}
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 수신함 - 지출결재 글의 총 페이지수를 알아오기 -->
	<select id="getSpendTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_spenda B
		on A.ano = B.fk_ano
		where apaper = '0'
		and (arecipient1 = #{userid} and approvaldate1 is null) or (arecipient2 = #{userid} and approvaldate2 is null) or (arecipient3 = #{userid} and approvaldate3 is null)
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and scat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 문서 지출결재문서 한 개 상세보기 -->
	<select id="myDocuSpend_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select scatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, scat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="scatname eq '지출결의서'">
				, to_char(exdate, 'yyyy-mm-dd') AS exdate, exprice
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				, to_char(codate, 'yyyy-mm-dd') AS codate, cocardnum, copurpose, coprice
			</when>	
		</choose>
		from tbl_approval a
		<choose>
			<when test="scatname eq '지출결의서'">
				left join tbl_expense e 
				on e.fk_ano = a.ano
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				left join tbl_cocard c 
				on c.fk_ano = a.ano
			</when>
		</choose>		
		left join tbl_spenda s
		on a.ano = s.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 2 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 수신함 - 근태결재문서에 해당하는 문서 조회하기 -->
	<select id="getVacation_reclist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, vno, vcatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, vno, vcatname
			from tbl_approval A join tbl_vacation B
			on A.ano = B.fk_ano
			where apaper = '0'
			and (arecipient1 = #{userid} and approvaldate1 is null) or (arecipient2 = #{userid} and approvaldate2 is null) or (arecipient3 = #{userid} and approvaldate3 is null)
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and vno in(${a})
			</if>
		) V
		where rno between #{startRno} and #{endRno}		
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 수신함 - 근태결재 글의 총 페이지수를 알아오기 -->
	<select id="getVacationTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_vacation B
		on A.ano = B.fk_ano
		where apaper = '0'
		and (arecipient1 = #{userid} and approvaldate1 is null) or (arecipient2 = #{userid} and approvaldate2 is null) or (arecipient3 = #{userid} and approvaldate3 is null)
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and vno in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 문서 근태결재문서 한 개 상세보기 -->
	<select id="myDocuVacation_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select vcatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, vno, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="vcatname eq '병가'">
				, to_char(slstart, 'yyyy/mm/dd') AS slstart, to_char(slend, 'yyyy/mm/dd') AS slend, sldates
			</when>
			<when test="vcatname eq '반차'">
				, to_char(afdate, 'yyyy/mm/dd') AS afdate, afdan, afdates
			</when>
			<when test="vcatname eq '연차'">
				, to_char(daystart, 'yyyy/mm/dd') AS daystart, to_char(dayend, 'yyyy/mm/dd') AS dayend, daydates
			</when>
			<when test="vcatname eq '경조휴가'">
				, to_char(congstart, 'yyyy/mm/dd') AS congstart, to_char(congend, 'yyyy/mm/dd') AS congend, congdates
			</when>
			<when test="vcatname eq '출장'">
				, to_char(bustart, 'yyyy/mm/dd') AS bustart, to_char(buend, 'yyyy/mm/dd') AS buend, budates, buplace, bupeople
			</when>
			<when test="vcatname eq '추가근무'">
				, ewdate, ewhours
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="vcatname eq '병가'">
				left join tbl_sickleave b 
				on b.fk_ano = a.ano
			</when>
			<when test="vcatname eq '반차'">
				left join tbl_afternoonoff c
				on c.fk_ano = a.ano
			</when>
			<when test="vcatname eq '연차'">
				left join tbl_dayoff d
				on d.fk_ano = a.ano
			</when>
			<when test="vcatname eq '경조휴가'">
				left join tbl_congoff e
				on e.fk_ano = a.ano
			</when>
			<when test="vcatname eq '출장'">
				left join tbl_businesstrip f
				on f.fk_ano = a.ano
			</when>
			<when test="vcatname eq '추가근무'">
				left join tbl_extrawork g
				on g.fk_ano = a.ano
			</when>			
		</choose>		
		left join tbl_vacation h
		on a.ano = h.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) i
		on a.fk_employeeid = i.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) j
		on i.fk_dcode = j.dcode
		left join tbl_position p
		on i.fk_pcode = p.pcode
		where anocode = 3 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 결재의견 작성하기 -->
	<insert id="addOpinion" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		insert into tbl_aopinion(ono, fk_ano, fk_employeeid, ocontent, odate)
		values(seq_tbl_aopinion.nextval, #{parentAno}, #{employeeid}, #{ocontent}, default)
	</insert>
	
	
	<!-- 내문서함 - 결재의견 조회하기 -->
	<select id="getOpinionList" parameterType="String" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select dname, name, pname, to_char(odate, 'yyyy-mm-dd hh24:mi:ss') AS odate, ocontent
		from tbl_aopinion a left join tbl_employee e
		on a.fk_employeeid = e.employeeid
		left join tbl_department d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where fk_ano = #{parentAno}
		order by odate
	</select>
	

	<!-- 내문서함 - 수신함 결재버튼 클릭 -->
	<update id="approval" parameterType="HashMap">
		<if test='fk_pcode neq "4"'>
			update tbl_approval set astatus = '1'
			<choose>
				<when test="arecipient2 == ''">
					, arecipient2 = (select managerid from tbl_employee where employeeid = #{employeeid}), approvaldate1 = sysdate
				</when>
				<when test="arecipient2 != '' and arecipient3 == ''">
					, arecipient3 = (select managerid from tbl_employee where employeeid = #{employeeid}), approvaldate2 = sysdate
				</when>
			</choose>
			where ano = #{ano} 
		</if>

		<if test='fk_pcode eq "4"'> 
			update tbl_approval set astatus = '3'
			<choose>
				<when test="arecipient2 == ''">
					, approvaldate1 = sysdate
				</when>
				<when test="arecipient2 != '' and arecipient3 == ''">
					, approvaldate2 = sysdate
				</when>
				<when test="arecipient2 != '' and arecipient3 != ''">
					, approvaldate3 = sysdate
				</when>
			</choose>
			where ano = #{ano}
		</if>
	</update>
	
	<!-- 내문서함 - 수신함 반려버튼 클릭 -->
	<update id="reject" parameterType="HashMap">
		update tbl_approval set astatus = '2'
		<choose>
			<when test="arecipient2 == ''">
				, approvaldate1 = sysdate
			</when>
			<when test="arecipient2 != '' and arecipient3 == ''">
				, approvaldate2 = sysdate
			</when>
			<when test="arecipient2 != '' and arecipient3 != ''">
				, approvaldate3 = sysdate
			</when>
		</choose>		
		where ano = #{ano}
	</update>
	
	<!-- ///////////////////////////////////////////////////////////////////// -->
	<!-- ///////////////////////////////////////////////////////////////////// -->
	
	
	<!-- 내문서함 - 발신함 - 일반결재문서에 해당하는 문서 조회하기  -->
	<select id="getnorm_sendlist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, ncat, ncatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, ncat, ncatname
			from tbl_approval A join tbl_norapproval B
			on A.ano = B.fk_ano
			where fk_employeeid = #{userid}
			and apaper = '0'
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and ncat in(${a})
			</if>			
		) V
		where rno between #{startRno} and #{endRno}
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 발신함 - 일반결재 글의 총 페이지수를 알아오기 -->
	<select id="getNormSendTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_norapproval B
		on A.ano = B.fk_ano
		where fk_employeeid = #{userid}
		and apaper = '0'
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and ncat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 발신함 - 일반결재문서 문서 한 개 상세보기 -->
	<select id="myDocuNorm_send_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select ncatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, ncat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="ncatname eq '회의록'">
				, mdate
			</when>
			<when test="ncatname eq '위임장'">
				, fk_wiimdate 
			</when>
			<when test="ncatname eq '협조공문'">
				, nvl(comname, '없습니다.') as comname
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="ncatname eq '회의록'">
				left join tbl_minutes m 
				on m.fk_ano = a.ano
			</when>
			<when test="ncatname eq '위임장'">
				left join tbl_wiimjang w 
				on w.fk_ano = a.ano
			</when>
			<when test="ncatname eq '협조공문'">
				left join tbl_coofficial c 
				on c.fk_ano = a.ano
			</when>
			<otherwise>
				left join tbl_exofficial e 
				on e.fk_ano = a.ano
			</otherwise>
		</choose>		
		left join tbl_norapproval n
		on a.ano = n.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 1 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 발신함 - 지출결재문서에 해당하는 문서 조회하기 -->
	<select id="getSpend_sendlist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, scat, scatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, scat, scatname
			from tbl_approval A join tbl_spenda B
			on A.ano = B.fk_ano
			where fk_employeeid = #{userid}
			and apaper != '0'
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and scat in(${a})
			</if>			
		) V
		where rno between #{startRno} and #{endRno}
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 발신함 - 지출결재 글의 총 페이지수를 알아오기 -->
	<select id="getSpendSendTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_spenda B
		on A.ano = B.fk_ano
		where fk_employeeid = #{userid}
		and apaper = '0'
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and scat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 발신함 - 지출 결재 문서 한 개 상세보기 -->
	<select id="myDocuSpend_send_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select scatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, scat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="scatname eq '지출결의서'">
				, to_char(exdate, 'yyyy-mm-dd') AS exdate, exprice
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				, to_char(codate, 'yyyy-mm-dd') AS codate, cocardnum, copurpose, coprice
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="scatname eq '지출결의서'">
				left join tbl_expense e 
				on e.fk_ano = a.ano
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				left join tbl_cocard c 
				on c.fk_ano = a.ano
			</when>
		</choose>		
		left join tbl_spenda s
		on a.ano = s.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 2 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 발신함 - 근태결재문서에 해당하는 문서 조회하기 -->
	<select id="getVacation_sendlist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, vno, vcatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, vno, vcatname
			from tbl_approval A join tbl_vacation B
			on A.ano = B.fk_ano
			where fk_employeeid = #{userid}
			and apaper = '0'
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and vno in(${a})
			</if>
		) V
		where rno between #{startRno} and #{endRno}		
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 발신함 - 근태결재 글의 총 페이지수를 알아오기 -->
	<select id="getVacationSendTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_vacation B
		on A.ano = B.fk_ano
		where fk_employeeid = #{userid}
		and apaper = '0'
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and vno in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 발신함 - 근태결재문서 한 개 상세보기 -->
	<select id="myDocuVacation_send_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select vcatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, vno, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="vcatname eq '병가'">
				, to_char(slstart, 'yyyy/mm/dd') AS slstart, to_char(slend, 'yyyy/mm/dd') AS slend, sldates
			</when>
			<when test="vcatname eq '반차'">
				, to_char(afdate, 'yyyy/mm/dd') AS afdate, afdan, afdates
			</when>
			<when test="vcatname eq '연차'">
				, to_char(daystart, 'yyyy/mm/dd') AS daystart, to_char(dayend, 'yyyy/mm/dd') AS dayend, daydates
			</when>
			<when test="vcatname eq '경조휴가'">
				, to_char(congstart, 'yyyy/mm/dd') AS congstart, to_char(congend, 'yyyy/mm/dd') AS congend, congdates
			</when>
			<when test="vcatname eq '출장'">
				, to_char(bustart, 'yyyy/mm/dd') AS bustart, to_char(buend, 'yyyy/mm/dd') AS buend, budates, buplace, bupeople
			</when>
			<when test="vcatname eq '추가근무'">
				, ewdate, ewhours
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="vcatname eq '병가'">
				left join tbl_sickleave b 
				on b.fk_ano = a.ano
			</when>
			<when test="vcatname eq '반차'">
				left join tbl_afternoonoff c
				on c.fk_ano = a.ano
			</when>
			<when test="vcatname eq '연차'">
				left join tbl_dayoff d
				on d.fk_ano = a.ano
			</when>
			<when test="vcatname eq '경조휴가'">
				left join tbl_congoff e
				on e.fk_ano = a.ano
			</when>
			<when test="vcatname eq '출장'">
				left join tbl_businesstrip f
				on f.fk_ano = a.ano
			</when>
			<when test="vcatname eq '추가근무'">
				left join tbl_extrawork g
				on g.fk_ano = a.ano
			</when>			
		</choose>		
		left join tbl_vacation h
		on a.ano = h.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) i
		on a.fk_employeeid = i.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) j
		on i.fk_dcode = j.dcode
		left join tbl_position p
		on i.fk_pcode = p.pcode
		where anocode = 3 and ano = #{ano}
	</select>
	
	
	<!-- ///////////////////////////////////////////////////////////////////// -->
	<!-- ///////////////////////////////////////////////////////////////////// -->
	
	<!-- 내문서함 - 임시저장함 - 일반결재문서에 해당하는 문서 조회하기  -->
	<select id="getnorm_templist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, ncat, ncatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, ncat, ncatname
			from tbl_approval A join tbl_norapproval B
			on A.ano = B.fk_ano
			where fk_employeeid = #{userid}
			and apaper = '2'
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and ncat in(${a})
			</if>			
		) V
		where rno between #{startRno} and #{endRno}
		order by ano desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 임시저장함 - 일반결재 글의 총 페이지수를 알아오기 -->
	<select id="getNormTempTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_norapproval B
		on A.ano = B.fk_ano
		where fk_employeeid = #{userid}
		and apaper = '2'
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and ncat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 임시저장함 - 일반결재문서 문서 한 개 상세보기 -->
	<select id="myDocuNorm_temp_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select ncatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, ncat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname
		<choose>
			<when test="ncatname eq '회의록'">
				, mdate
			</when>
			<when test="ncatname eq '위임장'">
				, fk_wiimdate 
			</when>
			<when test="ncatname eq '협조공문'">
				, nvl(comname, '없습니다.') as comname
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="ncatname eq '회의록'">
				left join tbl_minutes m 
				on m.fk_ano = a.ano
			</when>
			<when test="ncatname eq '위임장'">
				left join tbl_wiimjang w 
				on w.fk_ano = a.ano
			</when>
			<when test="ncatname eq '협조공문'">
				left join tbl_coofficial c 
				on c.fk_ano = a.ano
			</when>
			<otherwise>
				left join tbl_exofficial e 
				on e.fk_ano = a.ano
			</otherwise>
		</choose>		
		left join tbl_norapproval n
		on a.ano = n.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 1 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 임시저장함 - 지출결재문서에 해당하는 문서 조회하기 -->
	<select id="getSpend_templist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, scat, scatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, scat, scatname
			from tbl_approval A join tbl_spenda B
			on A.ano = B.fk_ano
			where fk_employeeid = #{userid}
			and apaper = '2'
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and scat in(${a})
			</if>			
		) V
		where rno between #{startRno} and #{endRno}
		order by ano desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 임시저장함 - 지출결재 글의 총 페이지수를 알아오기 -->
	<select id="getSpendTempTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_spenda B
		on A.ano = B.fk_ano
		where fk_employeeid = #{userid}
		and apaper = '2'
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and scat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 임시저장함 - 지출 결재 문서 한 개 상세보기 -->
	<select id="myDocuSpend_temp_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select scatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, scat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname 
		<choose>
			<when test="scatname eq '지출결의서'">
				, to_char(exdate, 'yyyy-mm-dd') AS exdate, exprice
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				, to_char(codate, 'yyyy-mm-dd') AS codate, cocardnum, copurpose, coprice
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="scatname eq '지출결의서'">
				left join tbl_expense e 
				on e.fk_ano = a.ano
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				left join tbl_cocard c 
				on c.fk_ano = a.ano
			</when>
		</choose>		
		left join tbl_spenda s
		on a.ano = s.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 2 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 임시저장함 - 근태결재문서에 해당하는 문서 조회하기 -->
	<select id="getVacation_templist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, vno, vcatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, vno, vcatname
			from tbl_approval A join tbl_vacation B
			on A.ano = B.fk_ano
			where fk_employeeid = #{userid}
			and apaper = '2'
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and vno in(${a})
			</if>
		) V
		where rno between #{startRno} and #{endRno}		
		order by ano desc, rno
	</select>
	
	
	<!-- 수신자 정보 select해오기 -->
	<select id="viewMng" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select name, employeeid, pname, dname
		from tbl_employee e left join tbl_position p
		on e.fk_pcode = p. pcode
		left join tbl_department d
		on e.fk_dcode = d.dcode
		where employeeid = (select managerid from tbl_employee where employeeid= #{userid}) 
	</select>
	
	
	<!-- ////////////////////////////////////////////////////////////////////// -->
	<!-- 내문서함 - 임시저장함 - 첨부파일 삭제 -->
	<update id="removeFile" parameterType="HashMap">
		update tbl_approval set fileName = null, orgFilename = null, fileSize = null
		where ano = #{ano}
	</update>
		
	
	<!-- 내문서함 - 임시저장함 - 삭제버튼 클릭 -->
	<delete id="remove" parameterType="HashMap">
		delete from tbl_approval
		where ano = #{ano}
	</delete>
	
	<!-- 문서번호에 따라 삭제해야할 파일 조회 -->
	<select id="getViewFile" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select fileName, orgFilename, fileSize
		from tbl_approval
		where ano = #{ano}
	</select>	
	
	
	<!-- 내문서함 - 임시저장함 - 저장버튼 클릭 -->	
	<!-- 전자결재 테이블 update 첨부파일 없는 경우 - 임시저장 상태 -->
	<update id="approvalSave" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		update tbl_approval set atitle = #{atitle}, asdate = sysdate, acontent = #{acontent}  
		where ano = #{ano}
	</update>	
	<!-- 전자결재 테이블 update 첨부파일 있는 경우 - 임시저장 상태 -->	
	<update id="approvalSave_withFile" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		update tbl_approval set atitle = #{atitle}, asdate = sysdate, acontent = #{acontent}, fileName = #{fileName}, orgFilename = #{orgFilename}, fileSize = #{fileSize}
		where ano = #{ano}
	</update>
	
	
	<!-- 내문서함 - 임시저장함 - 제출버튼 클릭 -->	
	<!-- 전자결재 테이블 update 첨부파일 없는 경우 - 임시저장 상태 -->
	<update id="approvalSubmit" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		update tbl_approval set atitle = #{atitle}, asdate = sysdate, acontent = #{acontent}, apaper = 0 
		where ano = #{ano}
	</update>	
	<!-- 전자결재 테이블 update 첨부파일 있는 경우 - 임시저장 상태 -->	
	<update id="approvalSubmit_withFile" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		update tbl_approval set atitle = #{atitle}, asdate = sysdate, acontent = #{acontent}, fileName = #{fileName}, orgFilename = #{orgFilename}, fileSize = #{fileSize}, apaper = 0
		where ano = #{ano}
	</update>
	
	
	<!-- 일반결재 문서종류에 따라 테이블에 update -->	 
	<update id="optionSave" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		<if test='ncatname eq "회의록"'>			
			update tbl_minutes set mdate = #{mdate}
			where fk_ano = #{ano}
		</if>
		<if test='ncatname eq "위임장"'>
			update tbl_wiimjang set fk_wiimdate = #{fk_wiimdate}
			where fk_ano = #{ano}
		</if>
		<if test='ncatname eq "협조공문"'>
			update tbl_coofficial set comname = #{comname}
			where fk_ano = #{ano}
		</if>
		<if test='ncatname eq "외부공문"'>
			update tbl_approval set asdate = sysdate
			where ano = #{ano}
		</if>
	</update>
	
	<!-- 지출결재 문서종류에 따라 테이블에 update -->	 
	<update id="optionSaveSpend" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		<if test='scatname eq "지출결의서"'>			
			update tbl_expense set exdate = #{exdate}, exprice = #{exprice}
			where fk_ano = #{ano}
		</if>
		<if test='scatname eq "법인카드사용신청서"'>
			update tbl_cocard set codate = #{codate}, cocardnum = #{cocardnum}, copurpose = #{copurpose}, coprice = #{coprice}
			where fk_ano = #{ano}
		</if>		
	</update>
	
	<!-- 근태결재 문서종류에 따라 테이블에 update -->
	<update id="optionSaveVacation" parameterType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		<if test='vcatname eq "병가"'>			
			update tbl_sickleave set slstart = #{slstart}, slend = #{slend}, sldates = #{sldates}
			where fk_ano = #{ano}
		</if>
		<if test='vcatname eq "반차"'>
			update tbl_afternoonoff set afdate = #{afdate}, afdan = #{afdan}, afdates = #{afdates}
			where fk_ano = #{ano}
		</if>
		<if test='vcatname eq "연차"'>
			update tbl_dayoff set daystart = #{daystart}, dayend = #{dayend}, daydates = #{daydates}
			where fk_ano = #{ano}
		</if>
		<if test='vcatname eq "경조휴가"'>
			update tbl_congoff set congstart = #{congstart}, congend = #{congend}, congdates = #{congdates}
			where fk_ano = #{ano}
		</if>
		<if test='vcatname eq "출장"'>
			update tbl_businesstrip set bustart = #{bustart}, buend = #{buend}, budates = #{budates}, buplace = #{buplace}, bupeople = #{bupeople} 
			where fk_ano = #{ano}
		</if>
		<if test='vcatname eq "추가근무"'>
			update tbl_extrawork set ewdate = #{ewdate}, ewhours = #{ewhours}
			where fk_ano = #{ano}
		</if>
	</update>
	
	<!-- ////////////////////////////////////////////////////////////////////// -->
	<!-- ////////////////////////////////////////////////////////////////////// -->
	
	<!-- 검색에 해당하는 임시저장함 - 근태결재 글의 총 페이지수를 알아오기 -->
	<select id="getVacationTempTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_vacation B
		on A.ano = B.fk_ano
		where fk_employeeid = #{userid}
		and apaper = '2'
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and vno in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 임시저장함 - 근태결재문서 한 개 상세보기 -->
	<select id="myDocuVacation_temp_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select vcatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, vno, pname 
		<choose>
			<when test="vcatname eq '병가'">
				, to_char(slstart, 'yyyy/mm/dd') AS slstart, to_char(slend, 'yyyy/mm/dd') AS slend, sldates
			</when>
			<when test="vcatname eq '반차'">
				, to_char(afdate, 'yyyy/mm/dd') AS afdate, afdan, afdates
			</when>
			<when test="vcatname eq '연차'">
				, to_char(daystart, 'yyyy/mm/dd') AS daystart, to_char(dayend, 'yyyy/mm/dd') AS dayend, daydates
			</when>
			<when test="vcatname eq '경조휴가'">
				, to_char(congstart, 'yyyy/mm/dd') AS congstart, to_char(congend, 'yyyy/mm/dd') AS congend, congdates
			</when>
			<when test="vcatname eq '출장'">
				, to_char(bustart, 'yyyy/mm/dd') AS bustart, to_char(buend, 'yyyy/mm/dd') AS buend, budates, buplace, bupeople
			</when>
			<when test="vcatname eq '추가근무'">
				, ewdate, ewhours
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="vcatname eq '병가'">
				left join tbl_sickleave b 
				on b.fk_ano = a.ano
			</when>
			<when test="vcatname eq '반차'">
				left join tbl_afternoonoff c
				on c.fk_ano = a.ano
			</when>
			<when test="vcatname eq '연차'">
				left join tbl_dayoff d
				on d.fk_ano = a.ano
			</when>
			<when test="vcatname eq '경조휴가'">
				left join tbl_congoff e
				on e.fk_ano = a.ano
			</when>
			<when test="vcatname eq '출장'">
				left join tbl_businesstrip f
				on f.fk_ano = a.ano
			</when>
			<when test="vcatname eq '추가근무'">
				left join tbl_extrawork g
				on g.fk_ano = a.ano
			</when>			
		</choose>		
		left join tbl_vacation h
		on a.ano = h.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) i
		on a.fk_employeeid = i.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) j
		on i.fk_dcode = j.dcode
		left join tbl_position p
		on i.fk_pcode = p.pcode
		where anocode = 3 and ano = #{ano}
	</select>
	
	<!-- ///////////////////////////////////////////////////////////////////// -->
	<!-- ///////////////////////////////////////////////////////////////////// -->	
	
	<!-- 내문서함 - 수신함 - 결재완료 - 일반결재문서에 해당하는 문서 조회하기  -->
	<select id="getnorm_completelist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, ncat, ncatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, ncat, ncatname
			from tbl_approval A join tbl_norapproval B
			on A.ano = B.fk_ano
			where (arecipient1 = #{userid} and approvaldate1 is not null) or (arecipient2 = #{userid} and approvaldate2 is not null) or (arecipient3 = #{userid} and approvaldate3 is not null)
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and ncat in(${a})
			</if>			
		) V
		where rno between #{startRno} and #{endRno}
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 수신함 - 결재완료 - 일반결재 글의 총 페이지수를 알아오기 -->
	<select id="getNormCompleteTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_norapproval B
		on A.ano = B.fk_ano
		where (arecipient1 = #{userid} and approvaldate1 is not null) or (arecipient2 = #{userid} and approvaldate2 is not null) or (arecipient3 = #{userid} and approvaldate3 is not null)
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and ncat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 수신함 - 결재완료 - 일반결재 문서 한 개 상세보기 -->
	<select id="myDocuNorm_complete_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select ncatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, ncat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="ncatname eq '회의록'">
				, mdate
			</when>
			<when test="ncatname eq '위임장'">
				, fk_wiimdate 
			</when>
			<when test="ncatname eq '협조공문'">
				, nvl(comname, '없습니다.') as comname
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="ncatname eq '회의록'">
				left join tbl_minutes m 
				on m.fk_ano = a.ano
			</when>
			<when test="ncatname eq '위임장'">
				left join tbl_wiimjang w 
				on w.fk_ano = a.ano
			</when>
			<when test="ncatname eq '협조공문'">
				left join tbl_coofficial c 
				on c.fk_ano = a.ano
			</when>
			<otherwise>
				left join tbl_exofficial e 
				on e.fk_ano = a.ano
			</otherwise>
		</choose>		
		left join tbl_norapproval n
		on a.ano = n.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 1 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 수신함 - 결재완료 - 지출결재문서에 해당하는 문서 조회하기 -->
	<select id="getSpend_completelist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, scat, scatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, scat, scatname
			from tbl_approval A join tbl_spenda B
			on A.ano = B.fk_ano
			where (arecipient1 = #{userid} and approvaldate1 is not null) or (arecipient2 = #{userid} and approvaldate2 is not null) or (arecipient3 = #{userid} and approvaldate3 is not null)
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and scat in(${a})
			</if>			
		) V
		where rno between #{startRno} and #{endRno}
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 수신함 - 결재완료 - 지출결재 글의 총 페이지수를 알아오기 -->
	<select id="getSpendCompleteTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_spenda B
		on A.ano = B.fk_ano
		where (arecipient1 = #{userid} and approvaldate1 is not null) or (arecipient2 = #{userid} and approvaldate2 is not null) or (arecipient3 = #{userid} and approvaldate3 is not null)
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and scat in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 수신함 - 결재완료 지출결재문서 한 개 상세보기 -->
	<select id="myDocuSpend_complete_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select scatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, scat, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="scatname eq '지출결의서'">
				, to_char(exdate, 'yyyy-mm-dd') AS exdate, exprice
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				, to_char(codate, 'yyyy-mm-dd') AS codate, cocardnum, copurpose, coprice
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="scatname eq '지출결의서'">
				left join tbl_expense e 
				on e.fk_ano = a.ano
			</when>
			<when test="scatname eq '법인카드사용신청서'">
				left join tbl_cocard c 
				on c.fk_ano = a.ano
			</when>
		</choose>		
		left join tbl_spenda s
		on a.ano = s.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) e
		on a.fk_employeeid = e.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) d
		on e.fk_dcode = d.dcode
		left join tbl_position p
		on e.fk_pcode = p.pcode
		where anocode = 2 and ano = #{ano}
	</select>
	
	
	<!-- 내문서함 - 수신함 - 결재완료 - 근태결재문서에 해당하는 문서 조회하기 -->
	<select id="getVacation_completelist" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select rno, atitle, ano, astatus, asdate, vno, vcatname 
		from
		(
			select row_number() over(order by asdate desc) as rno, atitle, ano, astatus, to_char(asdate, 'yyyy-mm-dd') AS asdate, vno, vcatname
			from tbl_approval A join tbl_vacation B
			on A.ano = B.fk_ano
			where (arecipient1 = #{userid} and approvaldate1 is not null) or (arecipient2 = #{userid} and approvaldate2 is not null) or (arecipient3 = #{userid} and approvaldate3 is not null)
			<if test='fromDate != "" and toDate != ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
			</if>
			<if test='fromDate != "" and toDate == ""'>
				and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
			</if>
			<if test='fromDate == "" and toDate != ""'>
				and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
			</if>
			<if test='astatus != ""'>
				and astatus = #{astatus}
			</if>
			<if test='sort == "" and searchWord != ""'>
				and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='sort != "" and searchWord != ""'>
				and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
			</if>
			<if test='a != ""'>
				and vno in(${a})
			</if>
		) V
		where rno between #{startRno} and #{endRno}		
		order by asdate desc, rno
	</select>
	
	
	<!-- 검색에 해당하는 수신함 - 결재완료 - 근태결재 글의 총 페이지수를 알아오기 -->
	<select id="getVacationCompleteTotalPage" parameterType="HashMap" resultType="int">
		select ceil(count(*) / #{sizePerPage})
		from tbl_approval A join tbl_vacation B
		on A.ano = B.fk_ano
		where (arecipient1 = #{userid} and approvaldate1 is not null) or (arecipient2 = #{userid} and approvaldate2 is not null) or (arecipient3 = #{userid} and approvaldate3 is not null)
		<if test='fromDate != "" and toDate != ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') between to_date(#{fromDate}, 'yyyy-mm-dd') and to_date(#{toDate}, 'yyyy-mm-dd')
		</if>
		<if test='fromDate != "" and toDate == ""'>
			and to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd') >= to_date(#{fromDate}, 'yyyy-mm-dd') 
		</if>
		<if test='fromDate == "" and toDate != ""'>
			and to_date(#{toDate}, 'yyyy-mm-dd') >= to_date(to_char(asdate, 'yyyy-mm-dd'), 'yyyy-mm-dd')
		</if>
		<if test='astatus != ""'>
			and astatus = #{astatus}
		</if>
		<if test='sort == "" and searchWord != ""'>
			and atitle like '%'|| lower(#{searchWord}) ||'%' or ano like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='sort != "" and searchWord != ""'>
			and lower(${sort}) like '%'|| lower(#{searchWord}) ||'%'
		</if>
		<if test='a != ""'>
			and vno in(${a})
		</if>
	</select>
	
	
	<!-- 내문서함 - 수신함 - 결재완료 근태결재문서 한 개 상세보기 -->
	<select id="myDocuVacation_complete_detail" parameterType="HashMap" resultType="com.t1works.groupware.sia.model.ApprovalSiaVO">
		select vcatname, arecipient1, atitle, name, dname, apaper, a.ano, acontent, fileName, orgFilename, fileSize, astatus, vno, to_char(asdate, 'yyyy')||'년 '||to_char(asdate, 'mm')||'월 '||to_char(asdate, 'dd')||'일' AS asdate, pname, arecipient2, arecipient3, approvaldate1, approvaldate2, approvaldate3 
		<choose>
			<when test="vcatname eq '병가'">
				, to_char(slstart, 'yyyy/mm/dd') AS slstart, to_char(slend, 'yyyy/mm/dd') AS slend, sldates
			</when>
			<when test="vcatname eq '반차'">
				, to_char(afdate, 'yyyy/mm/dd') AS afdate, afdan, afdates
			</when>
			<when test="vcatname eq '연차'">
				, to_char(daystart, 'yyyy/mm/dd') AS daystart, to_char(dayend, 'yyyy/mm/dd') AS dayend, daydates
			</when>
			<when test="vcatname eq '경조휴가'">
				, to_char(congstart, 'yyyy/mm/dd') AS congstart, to_char(congend, 'yyyy/mm/dd') AS congend, congdates
			</when>
			<when test="vcatname eq '출장'">
				, to_char(bustart, 'yyyy/mm/dd') AS bustart, to_char(buend, 'yyyy/mm/dd') AS buend, budates, buplace, bupeople
			</when>
			<when test="vcatname eq '추가근무'">
				, ewdate, ewhours
			</when>
		</choose>
		from tbl_approval a
		<choose>
			<when test="vcatname eq '병가'">
				left join tbl_sickleave b 
				on b.fk_ano = a.ano
			</when>
			<when test="vcatname eq '반차'">
				left join tbl_afternoonoff c
				on c.fk_ano = a.ano
			</when>
			<when test="vcatname eq '연차'">
				left join tbl_dayoff d
				on d.fk_ano = a.ano
			</when>
			<when test="vcatname eq '경조휴가'">
				left join tbl_congoff e
				on e.fk_ano = a.ano
			</when>
			<when test="vcatname eq '출장'">
				left join tbl_businesstrip f
				on f.fk_ano = a.ano
			</when>
			<when test="vcatname eq '추가근무'">
				left join tbl_extrawork g
				on g.fk_ano = a.ano
			</when>			
		</choose>		
		left join tbl_vacation h
		on a.ano = h.fk_ano
		left join 
		(
			select employeeid, name, fk_dcode, fk_pcode
			from tbl_employee 
		) i
		on a.fk_employeeid = i.employeeid
		left join 
		(
			select dcode, dname
			from tbl_department
		) j
		on i.fk_dcode = j.dcode
		left join tbl_position p
		on i.fk_pcode = p.pcode
		where anocode = 3 and ano = #{ano}
	</select>	
	
</mapper>